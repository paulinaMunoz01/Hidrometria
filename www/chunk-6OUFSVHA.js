import{a as me}from"./chunk-MA3DRUQN.js";import{$ as Y,A as B,Aa as ae,B as E,Ba as ne,C as g,Ca as oe,Da as se,Ea as ce,Fa as he,G as s,Ga as le,H as c,Ha as de,I as w,Ia as pe,K as H,Ma as ue,N,Na as ge,O as U,P as Q,Q as V,R as Z,S as h,T as y,U as D,Z as q,_ as K,a as P,b as j,c as O,d as M,e as _,f as z,g as R,h as A,i as T,j as W,k as L,l as G,m as x,n as k,o as v,p as F,r as b,ra as J,sa as X,u as l,v as $,w as I,wa as ee,x as d,xa as te,y as p,ya as re,z as f,za as ie}from"./chunk-RIP2PPFB.js";import"./chunk-7NBJJYDZ.js";import"./chunk-GBYUAKBO.js";import"./chunk-TFHXA6LG.js";import"./chunk-6L6JLL4O.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-4YKAI63M.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as m}from"./chunk-RW4GY4BD.js";var Se=["*"];var o=function(r){return r.AnnotationChart="AnnotationChart",r.AreaChart="AreaChart",r.Bar="Bar",r.BarChart="BarChart",r.BubbleChart="BubbleChart",r.Calendar="Calendar",r.CandlestickChart="CandlestickChart",r.ColumnChart="ColumnChart",r.ComboChart="ComboChart",r.PieChart="PieChart",r.Gantt="Gantt",r.Gauge="Gauge",r.GeoChart="GeoChart",r.Histogram="Histogram",r.Line="Line",r.LineChart="LineChart",r.Map="Map",r.OrgChart="OrgChart",r.Sankey="Sankey",r.Scatter="Scatter",r.ScatterChart="ScatterChart",r.SteppedAreaChart="SteppedAreaChart",r.Table="Table",r.Timeline="Timeline",r.TreeMap="TreeMap",r.WordTree="WordTree",r}(o||{}),Oe={[o.AnnotationChart]:"annotationchart",[o.AreaChart]:"corechart",[o.Bar]:"bar",[o.BarChart]:"corechart",[o.BubbleChart]:"corechart",[o.Calendar]:"calendar",[o.CandlestickChart]:"corechart",[o.ColumnChart]:"corechart",[o.ComboChart]:"corechart",[o.PieChart]:"corechart",[o.Gantt]:"gantt",[o.Gauge]:"gauge",[o.GeoChart]:"geochart",[o.Histogram]:"corechart",[o.Line]:"line",[o.LineChart]:"corechart",[o.Map]:"map",[o.OrgChart]:"orgchart",[o.Sankey]:"sankey",[o.Scatter]:"scatter",[o.ScatterChart]:"corechart",[o.SteppedAreaChart]:"corechart",[o.Table]:"table",[o.Timeline]:"timeline",[o.TreeMap]:"treemap",[o.WordTree]:"wordtree"};function Me(r){return Oe[r]}function fe(){return{version:"current",safeMode:!1}}var Ce=new x("GOOGLE_CHARTS_CONFIG"),ze=new x("GOOGLE_CHARTS_LAZY_CONFIG",{providedIn:"root",factory:()=>{let r=F(Ce,k.Optional);return M(m(m({},fe()),r||{}))}}),S=(()=>{let a=class a{constructor(e,t,i){this.zone=e,this.localeId=t,this.config$=i,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new j}isGoogleChartsAvailable(){return!(typeof google>"u"||typeof google.charts>"u")}loadChartPackages(...e){return this.loadGoogleCharts().pipe(R(()=>this.config$),_(t=>m(m({},fe()),t||{})),W(t=>new P(i=>{let n={packages:e,language:this.localeId,mapsApiKey:t.mapsApiKey,safeMode:t.safeMode};google.charts.load(t.version,n),google.charts.setOnLoadCallback(()=>{this.zone.run(()=>{i.next(),i.complete()})})})))}loadGoogleCharts(){if(this.isGoogleChartsAvailable())return M(void 0);if(!this.isLoadingGoogleCharts()){let e=this.createGoogleChartsScript();e.onload=()=>{this.zone.run(()=>{this.scriptLoadSubject.next(),this.scriptLoadSubject.complete()})},e.onerror=()=>{this.zone.run(()=>{console.error("Failed to load the google charts script!"),this.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))})}}return this.scriptLoadSubject.asObservable()}isLoadingGoogleCharts(){return this.getGoogleChartsScript()!=null}getGoogleChartsScript(){return Array.from(document.getElementsByTagName("script")).find(t=>t.src===this.scriptSource)}createGoogleChartsScript(){let e=document.createElement("script");return e.type="text/javascript",e.src=this.scriptSource,e.async=!0,document.getElementsByTagName("head")[0].appendChild(e),e}};a.\u0275fac=function(t){return new(t||a)(v($),v(q),v(ze))},a.\u0275prov=L({token:a,factory:a.\u0275fac});let r=a;return r})();var ve=(()=>{let a=class a{create(e,t,i){if(e==null)return;let n=!0;t!=null&&(n=!1);let u=google.visualization.arrayToDataTable(this.getDataAsTable(e,t),n);return i&&this.applyFormatters(u,i),u}getDataAsTable(e,t){return t?[t,...e]:e}applyFormatters(e,t){for(let i of t)i.formatter.format(e,i.colIndex)}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=L({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();function Le(){return"_"+Math.random().toString(36).substr(2,9)}var xe=(()=>{let a=class a{constructor(e){this.loaderService=e,this.error=new l,this.ready=new l,this.stateChange=new l,this.id=Le(),this.wrapperReadySubject=new O(1)}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get controlWrapper(){if(!this._controlWrapper)throw new Error("Cannot access the control wrapper before it being initialized.");return this._controlWrapper}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.createControlWrapper()})}ngOnChanges(e){this._controlWrapper&&(e.type&&this._controlWrapper.setControlType(this.type),e.options&&this._controlWrapper.setOptions(this.options||{}),e.state&&this._controlWrapper.setState(this.state||{}))}createControlWrapper(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)}addEventListeners(){google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",e=>this.ready.emit(e)),google.visualization.events.addListener(this._controlWrapper,"error",e=>this.error.emit(e)),google.visualization.events.addListener(this._controlWrapper,"statechange",e=>this.stateChange.emit(e))}};a.\u0275fac=function(t){return new(t||a)(p(S))},a.\u0275cmp=f({type:a,selectors:[["control-wrapper"]],hostAttrs:[1,"control-wrapper"],hostVars:1,hostBindings:function(t,i){t&2&&H("id",i.id)},inputs:{for:"for",type:"type",options:"options",state:"state"},outputs:{error:"error",ready:"ready",stateChange:"stateChange"},exportAs:["controlWrapper"],standalone:!1,features:[b],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0});let r=a;return r})(),Ie=(()=>{let a=class a{constructor(e,t,i){this.element=e,this.loaderService=t,this.dataTableService=i,this.ready=new l,this.error=new l,this.initialized=!1}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.createDashboard(),this.initialized=!0})}ngOnChanges(e){this.initialized&&(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.dashboard.draw(this.dataTable))}createDashboard(){let e=this.controlWrappers.map(i=>i.wrapperReady$),t=this.controlWrappers.map(i=>i.for).map(i=>Array.isArray(i)?z(i.map(n=>n.wrapperReady$)):i.wrapperReady$);z([...e,...t]).subscribe(()=>{this.dashboard=new google.visualization.Dashboard(this.element.nativeElement),this.initializeBindings(),this.registerEvents(),this.dashboard.draw(this.dataTable)})}registerEvents(){google.visualization.events.removeAllListeners(this.dashboard);let e=(t,i,n)=>{google.visualization.events.addListener(t,i,n)};e(this.dashboard,"ready",()=>this.ready.emit()),e(this.dashboard,"error",t=>this.error.emit(t))}initializeBindings(){this.controlWrappers.forEach(e=>{if(Array.isArray(e.for)){let t=e.for.map(i=>i.chartWrapper);this.dashboard.bind(e.controlWrapper,t)}else this.dashboard.bind(e.controlWrapper,e.for.chartWrapper)})}};a.\u0275fac=function(t){return new(t||a)(p(I),p(S),p(ve))},a.\u0275cmp=f({type:a,selectors:[["dashboard"]],contentQueries:function(t,i,n){if(t&1&&Q(n,xe,4),t&2){let u;V(u=Z())&&(i.controlWrappers=u)}},hostAttrs:[1,"dashboard"],inputs:{data:"data",columns:"columns",formatters:"formatters"},outputs:{ready:"ready",error:"error"},exportAs:["dashboard"],standalone:!1,features:[b],ngContentSelectors:Se,decls:1,vars:0,template:function(t,i){t&1&&(N(),U(0))},encapsulation:2,changeDetection:0});let r=a;return r})(),be=(()=>{let a=class a{constructor(e,t,i,n){this.element=e,this.scriptLoaderService=t,this.dataTableService=i,this.dashboard=n,this.options={},this.dynamicResize=!1,this.ready=new l,this.error=new l,this.select=new l,this.mouseover=new l,this.mouseleave=new l,this.wrapperReadySubject=new O(1),this.initialized=!1,this.eventListeners=new Map}get chart(){return this.chartWrapper.getChart()}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get chartWrapper(){if(!this.wrapper)throw new Error("Trying to access the chart wrapper before it was fully initialized");return this.wrapper}set chartWrapper(e){this.wrapper=e,this.drawChart()}ngOnInit(){this.scriptLoaderService.loadChartPackages(Me(this.type)).subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper=new google.visualization.ChartWrapper({container:this.element.nativeElement,chartType:this.type,dataTable:this.dataTable,options:this.mergeOptions()}),this.registerChartEvents(),this.wrapperReadySubject.next(this.wrapper),this.initialized=!0,this.drawChart()})}ngOnChanges(e){if(e.dynamicResize&&this.updateResizeListener(),this.initialized){let t=!1;(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper.setDataTable(this.dataTable),t=!0),e.type&&(this.wrapper.setChartType(this.type),t=!0),(e.options||e.width||e.height||e.title)&&(this.wrapper.setOptions(this.mergeOptions()),t=!0),t&&this.drawChart()}}ngOnDestroy(){this.unsubscribeToResizeIfSubscribed()}addEventListener(e,t){let i=this.registerChartEvent(this.chart,e,t);return this.eventListeners.set(i,{eventName:e,callback:t,handle:i}),i}removeEventListener(e){let t=this.eventListeners.get(e);t&&(google.visualization.events.removeListener(t.handle),this.eventListeners.delete(e))}updateResizeListener(){this.unsubscribeToResizeIfSubscribed(),this.dynamicResize&&(this.resizeSubscription=A(window,"resize",{passive:!0}).pipe(T(100)).subscribe(()=>{this.initialized&&this.drawChart()}))}unsubscribeToResizeIfSubscribed(){this.resizeSubscription!=null&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=void 0)}mergeOptions(){return m({title:this.title,width:this.width,height:this.height},this.options)}registerChartEvents(){google.visualization.events.removeAllListeners(this.wrapper),this.registerChartEvent(this.wrapper,"ready",()=>{google.visualization.events.removeAllListeners(this.chart),this.registerChartEvent(this.chart,"onmouseover",e=>this.mouseover.emit(e)),this.registerChartEvent(this.chart,"onmouseout",e=>this.mouseleave.emit(e)),this.registerChartEvent(this.chart,"select",()=>{let e=this.chart.getSelection();this.select.emit({selection:e})}),this.eventListeners.forEach(e=>e.handle=this.registerChartEvent(this.chart,e.eventName,e.callback)),this.ready.emit({chart:this.chart})}),this.registerChartEvent(this.wrapper,"error",e=>this.error.emit(e))}registerChartEvent(e,t,i){return google.visualization.events.addListener(e,t,i)}drawChart(){this.dashboard==null&&this.wrapper.draw()}};a.\u0275fac=function(t){return new(t||a)(p(I),p(S),p(ve),p(Ie,8))},a.\u0275cmp=f({type:a,selectors:[["google-chart"]],hostAttrs:[1,"google-chart"],inputs:{type:"type",data:"data",columns:"columns",title:"title",width:"width",height:"height",options:"options",formatters:"formatters",dynamicResize:"dynamicResize"},outputs:{ready:"ready",error:"error",select:"select",mouseover:"mouseover",mouseleave:"mouseleave"},exportAs:["googleChart"],standalone:!1,features:[b],decls:0,vars:0,template:function(t,i){},styles:["[_nghost-%COMP%]{width:-moz-fit-content;width:fit-content;display:block}"],changeDetection:0});let r=a;return r})();var we=(()=>{let a=class a{static forRoot(e={}){return{ngModule:a,providers:[{provide:Ce,useValue:e}]}}};a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=B({type:a}),a.\u0275inj=G({providers:[S]});let r=a;return r})();function De(r,a){if(r&1&&(s(0,"ion-item")(1,"ion-label"),h(2),c()()),r&2){let C=a.$implicit;d(2),y(C)}}function Pe(r,a){if(r&1&&(s(0,"ion-accordion")(1,"ion-item",8)(2,"ion-label"),h(3),c()(),s(4,"div",9)(5,"ion-list"),E(6,De,3,1,"ion-item",7),c()()()),r&2){let C=a.$implicit;d(3),y(C.mes),d(3),g("ngForOf",C.consumo)}}var Xe=(()=>{let a=class a{constructor(e){this.usersService=e,this.totalConsumo=0,this.promedioDiario=0,this.diasCriticos=0,this.chartType=o.PieChart,this.chartColumns=["D\xEDa","Litros"],this.chartData=[],this.comparisonChartType=o.ColumnChart,this.comparisonChartColumns=["Mes","Litros Consumidos"],this.comparisonChartData=[],this.radarChartType=o.LineChart,this.radarChartColumns=["D\xEDa","Consumo Real (L)","Consumo Promedio (L)"],this.radarChartData=[],this.historialMensual=[]}ngOnInit(){this.usersService.getFlujoAgua().subscribe(e=>{let t=e.Respuesta;this.totalConsumo=t.reduce((n,u)=>n+u.litros,0),this.promedioDiario=this.totalConsumo/30,this.diasCriticos=t.filter(n=>n.litros>50).length,this.chartData=t.map(n=>[n.fecha,n.litros]);let i=this.agruparPorMes(t);this.comparisonChartData=i.map(n=>[n.mes,n.total_litros]),this.radarChartData=t.map(n=>[n.fecha,n.litros,this.promedioDiario]),this.historialMensual=this.agruparHistorialPorMes(t)})}agruparPorMes(e){let t={};return e.forEach(i=>{let n=i.fecha.split("-")[1];t[n]||(t[n]=0),t[n]+=i.litros}),Object.keys(t).map(i=>({mes:i,total_litros:t[i]}))}agruparHistorialPorMes(e){let t={};return e.forEach(i=>{let n=i.fecha.split("-")[1];t[n]||(t[n]={mes:`Mes ${n}`,consumo:[],abierto:!1}),t[n].consumo.push(`D\xEDa ${i.fecha.split("-")[2]}: ${i.litros}L`)}),Object.values(t)}toggleHistorial(e){e.abierto=!e.abierto}};a.\u0275fac=function(t){return new(t||a)(p(me))},a.\u0275cmp=f({type:a,selectors:[["app-tab1"]],decls:50,vars:14,consts:[["id","title",3,"translucent"],["id","header"],[1,"ion-padding"],[1,"headAdmin"],["size","12","size-sm","4"],["size","12","size-lg","4",1,"ion-col"],[3,"type","data","columns"],[4,"ngFor","ngForOf"],["slot","header"],["slot","content"]],template:function(t,i){t&1&&(s(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),h(3,"HidroMetria"),c()()(),s(4,"ion-content",2)(5,"div",3)(6,"h2"),h(7,"Dashboard"),c(),s(8,"p"),h(9,"Informe del consumo del agua"),c()(),s(10,"ion-grid")(11,"ion-row")(12,"ion-col",4)(13,"ion-card")(14,"ion-card-header")(15,"ion-card-title"),h(16,"Total Consumo"),c()(),s(17,"ion-card-content")(18,"h2"),h(19),c()()()(),s(20,"ion-col",4)(21,"ion-card")(22,"ion-card-header")(23,"ion-card-title"),h(24,"Promedio Diario"),c()(),s(25,"ion-card-content")(26,"h2"),h(27),c()()()(),s(28,"ion-col",4)(29,"ion-card")(30,"ion-card-header")(31,"ion-card-title"),h(32,"Mes"),c()(),s(33,"ion-card-content")(34,"h2"),h(35),c()()()()()(),s(36,"ion-grid")(37,"ion-row")(38,"ion-col",5),w(39,"google-chart",6),c(),s(40,"ion-col",5),w(41,"google-chart",6),c(),s(42,"ion-col",5),w(43,"google-chart",6),c()()(),s(44,"ion-list")(45,"ion-item-divider")(46,"ion-label"),h(47,"Historial de Consumo"),c()(),s(48,"ion-accordion-group"),E(49,Pe,7,2,"ion-accordion",7),c()()()),t&2&&(g("translucent",!1),d(19),D("",i.totalConsumo," L"),d(8),D("",i.promedioDiario," L"),d(8),y(i.diasCriticos),d(4),g("type",i.chartType)("data",i.chartData)("columns",i.chartColumns),d(2),g("type",i.comparisonChartType)("data",i.comparisonChartData)("columns",i.comparisonChartColumns),d(2),g("type",i.radarChartType)("data",i.radarChartData)("columns",i.radarChartColumns),d(6),g("ngForOf",i.historialMensual))},dependencies:[Y,K,we,be,se,ge,ue,ne,oe,pe,ae,ee,re,ie,te,de,he,le,X,J,ce],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: #f4f7fc;padding:15px}ion-header[_ngcontent-%COMP%]{--ion-background-color: #073359}#title[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]{--background: #073359}#header[_ngcontent-%COMP%]{color:#fff;text-align:center;letter-spacing:3px}#titulo[_ngcontent-%COMP%]{text-align:center;font-size:2.5rem;font-weight:700;color:#4880b8;margin-top:20px;letter-spacing:1px;font-family:Lucida Sans,Lucida Sans Regular,Lucida Grande,Lucida Sans Unicode,Geneva,Verdana,sans-serif}ion-accordion-group[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:0 4px 10px #0000001a;padding:10px}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item-divider[_ngcontent-%COMP%]{background:#1e88e5;color:#fff;font-size:1.1rem;font-weight:700;text-align:center}google-chart[_ngcontent-%COMP%]{width:100%;max-width:400px;height:auto;display:block;margin:0 auto}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.historial[_ngcontent-%COMP%]{width:100%;max-width:400px}.historial-item[_ngcontent-%COMP%]{background:#f1f1f1;padding:10px;margin:5px 0;border-radius:10px}.charts-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;flex-wrap:wrap}#ion-col[_ngcontent-%COMP%]{margin:20px}ion-card[_ngcontent-%COMP%]{background:#e9f2fc;border-radius:12px;box-shadow:0 4px 10px #0000001a;text-align:center;padding:10px;transition:transform .2s ease-in-out}ion-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{background:transparent;font-weight:700;color:#357abd}ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#285a8e}ion-label[_ngcontent-%COMP%]{font-size:16px;color:#fff;text-transform:uppercase;letter-spacing:1px}ion-item[slot=header][_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#000}div[slot=content][_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#004a99;font-size:14px;font-weight:400}ion-item-divider[_ngcontent-%COMP%]{--background: transparent !important;--color: #333;font-size:18px;font-weight:700;text-transform:uppercase;letter-spacing:1px;border-bottom:2px solid rgba(0,0,0,.1);padding:10px 16px}.ion-col[_ngcontent-%COMP%]{margin-bottom:40px}#titulo[_ngcontent-%COMP%]{text-align:center;font-size:2.5rem;font-weight:700;color:#4880b8;letter-spacing:1px;font-family:Lucida Sans,Lucida Sans Regular,Lucida Grande,Lucida Sans Unicode,Geneva,Verdana,sans-serif}.headAdmin[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#5a5a5a}']});let r=a;return r})();export{Xe as Tab1Page};
